<?xml version="1.0" encoding="UTF-8"?>
<model xmlns="http://www.qcadoo.com/model" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.qcadoo.com/model model.xsd">
    <entities>
        <entity name="equipmentHealth" package="com.qcadoo.mes.predictiveMaintenance" extends="basic">
            <fields>
                <field name="equipment" type="manyToOne" searchable="true" required="true">
                    <manyToOne>
                        <field name="mappedBy" value="equipmentHealths"/>
                        <field name="toEntityName" value="basic.equipment"/>
                    </manyToOne>
                </field>
                <field name="healthScore" type="decimal" required="true" min="0" max="100">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="status" type="string" required="true">
                    <constraints>
                        <notBlank/>
                        <pattern>^(GOOD|WARNING|CRITICAL)$</pattern>
                    </constraints>
                </field>
                <field name="lastMeasurement" type="dateTime" required="true"/>
                <field name="nextPredictedFailure" type="dateTime"/>
                <field name="failureProbability" type="decimal" min="0" max="1">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="maintenancePriority" type="integer" min="1" max="5">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="notes" type="text"/>
                <field name="measurements" type="oneToMany">
                    <oneToMany>
                        <field name="mappedBy" value="equipmentHealth"/>
                        <field name="toEntityName" value="predictiveMaintenance.equipmentMeasurement"/>
                    </oneToMany>
                </field>
            </fields>
        </entity>
        <entity name="equipmentMeasurement" package="com.qcadoo.mes.predictiveMaintenance" extends="basic">
            <fields>
                <field name="equipmentHealth" type="manyToOne" searchable="true" required="true">
                    <manyToOne>
                        <field name="mappedBy" value="measurements"/>
                        <field name="toEntityName" value="predictiveMaintenance.equipmentHealth"/>
                    </manyToOne>
                </field>
                <field name="timestamp" type="dateTime" required="true"/>
                <field name="sensorType" type="string" required="true">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="value" type="decimal" required="true">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="unit" type="string" required="true">
                    <constraints>
                        <notBlank/>
                    </constraints>
                </field>
                <field name="isAnomaly" type="boolean" default="false"/>
            </fields>
        </entity>
    </entities>
</model>